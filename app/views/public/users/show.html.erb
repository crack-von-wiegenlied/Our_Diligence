<!--ユーザー画面-->
<div class="container-fluid">
  <div><%= flash[:notice] %></div>
  <div class="row">
    <div class="col-lg-9 col-sm-12">
      <div class="m-3">
        <%= image_tag @user.get_image(100, 100) %>
        <h4><%= @user.name %></h4>
        <%= link_to "フォローリスト", user_followings_path(@user) %>
        <%= link_to "フォロワーリスト", user_followers_path(@user) %>

        <% unless @user == current_user %>
          <% if current_user.following?(@user) %>
            <%= link_to "フォローを外す", user_relationships_path(@user.id), method: :delete %>
          <% else %>
            <%= link_to "フォローする", user_relationships_path(@user.id), method: :post %>
          <% end %>
        <% end %>
      </div>

      <%= month_calendar(events: @user.posts) do |date, posts| %>
        <%= date.day %>

        <% posts.each do |post| %>
          <div>
            <%= link_to post_path(post) do %>
              <%= post.title %>
            <% end %>
          </div>
        <% end %>
      <% end %>

    </div>

    <div class="col-lg-3 col-sm-12 mt-3">
      <%= link_to  new_post_path do %>
        <p><i class="fas fa-pen"></i>新規投稿</p>
      <% end %>

      <%= link_to timeline_path do %>
        <p><i class="fas fa-users"></i>フォロー中のユーザーの投稿</p>
      <% end %>

      <%= link_to posts_path do %>
        <p><i class="fas fa-globe"></i>みんなの投稿</p>
      <% end %>

      <div class="category_search my-2 border p-2">
        <h6>カテゴリー検索</h6>
        <%= form_with url: category_path(:id), method: :get do |f| %>
          <%= f.select :category_id, options_from_collection_for_select(Category.all, :id, :name) %>
          <%= f.submit "検索" %>
        <% end %>
      </div>

      <div class="search_form mt-3 border p-2">
        <h6>キーワード検索</h6>
        <%= form_with url: search_path, method: :get do |f| %>
          <%= f.text_field :word %>
          <%= f.select :range, options_for_select([["ユーザー検索", "User"], ["投稿検索", "Post"]]) %>
          <%= f.select :search, options_for_select([["完全一致", "perfect_match"], ["前方一致", "forward_match"],
                                                    ["後方一致", "backward_match"],["部分一致", "partial_match"]]) %>
          <%= f.submit "検索" %>
        <% end %>
      </div>

      <% if (@user == current_user) && (@user.name != "guestuser") %>
        <div>
          <%= link_to edit_user_path(@user) do %>
            <p class="mt-3"><i class="fas fa-user-cog"></i>プロフィールを編集する</p>
          <% end %>
        </div>
        <div>
          <%= link_to "退会する", unsubscribe_path(@user) %>
        </div>
      <% end %>


    </div>



  </div>
</div>


